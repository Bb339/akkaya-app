<!DOCTYPE html>
<html lang="tr">
<head>
    <link rel="icon" href="/favicon.ico">
  <meta charset="UTF-8" />
  <title>Akkaya BarajÄ± â€“ Optimum Bitki Deseni Paneli</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css?v=114" />
  <!-- Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <!-- Esri Leaflet for uydu gÃ¶rÃ¼ntÃ¼sÃ¼ -->
  <script src="https://unpkg.com/esri-leaflet@3.0.11/dist/esri-leaflet.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div>
        <h1>Akkaya BarajÄ± â€“ Optimum Bitki Deseni Paneli</h1>
        <p>NiÄŸde Akkaya barajÄ± Ã§evresindeki parseller iÃ§in suâ€“kÃ¢r analizi ve senaryo karÅŸÄ±laÅŸtÄ±rmasÄ±</p>
      </div>
      <div class="header-badge">Panel</div>
    </header>

    <main class="app-main">
      <section class="layout">
        <!-- Sol kolon -->
        <div class="left-col">
          <!-- 1) Parsel + veri kaynaÄŸÄ± -->
          <div class="card">
            <h2 class="card-title">Parsel seÃ§</h2>
            <select id="parcelSelect" class="select-input"></select>

            <div class="algo-actions">
              <button id="runOptBtn" class="btn-primary">Optimizasyonu Ã‡alÄ±ÅŸtÄ±r</button>
              <span id="algoStatus" class="algo-status">HazÄ±r</span>
            </div>

            <div class="data-loader">
              <div class="data-status">
                Veri kaynaÄŸÄ±: <strong id="dataSourceLabel">Backend/CSV</strong>
                <span id="dataLoadBadge" class="badge badge-warn">CSV baÄŸlanmadÄ±</span>
              </div>
              <div class="data-actions">
                <input id="dataFileInput" type="file" accept=".csv" multiple class="file-input" />
                <button id="loadDefaultCsvBtn" class="btn-secondary">Projeden CSV yÃ¼kle</button>
              </div>

              <div id="activeFilesBox" class="active-files">
                <div class="active-files-title">Aktif dosyalar</div>
                <div id="activeFilesBadges" class="active-files-badges"></div>
              </div>

              <p class="card-help small">
                Not: CSV dosyalarÄ± otomatik okunabilmesi iÃ§in projeyi â€œLive Serverâ€ ile aÃ§Ä±n (Ã¶rn. VS Code Live Server).
                Ä°stersen CSV'leri buradan manuel seÃ§ip de yÃ¼kleyebilirsin.
              </p>
            </div>
          </div>

          <!-- 2) Optimizasyon algoritmasÄ± (aktif dosyalar ile senaryo arasÄ±na) -->
          <div class="card" id="algoCard">
            <h2 class="card-title">Optimizasyon algoritmasÄ±</h2>
            <select id="algoSelect" class="select-input">
              <option value="ga" selected>Genetik Algoritma (GA)</option>
              <option value="abc">Yapay ArÄ± Kolonisi AlgoritmasÄ± (ABC)</option>
              <option value="aco">KarÄ±nca Koloni Optimizasyonu (ACO)</option>
            </select>
          </div>

          <!-- Algoritma karÅŸÄ±laÅŸtÄ±rmasÄ± (benchmark) sekme olarak saÄŸ tarafta gÃ¶sterilir -->

          <!-- 3) Senaryo -->
          <div class="card" id="scenarioCard">
            <h2 class="card-title">Senaryo</h2>
            <div class="radio-group">
              <label><input type="radio" name="scenario" value="mevcut" checked /> Mevcut desen</label>
              <label><input type="radio" name="scenario" value="su_tasarruf" /> Su tasarruf odaklÄ±</label>
              <!-- Proje hedefi: her zaman su tasarrufu. "Maksimum kÃ¢r" seÃ§eneÄŸi bilinÃ§li olarak kaldÄ±rÄ±ldÄ±. -->
            </div>

            <div class="water-controls" style="padding-top:6px;">
              <div class="field-row">
                <label class="field-label">Sezon veri seti</label>
                <select id="seasonSourceSel" class="select-input">
                  <option value="s1" selected>Senaryo-1 (tek baÅŸÄ±na)</option>
                  <option value="s2">Senaryo-2 (tek baÅŸÄ±na)</option>
                </select>
              </div>
              <p class="card-help small" style="margin-top:6px;">
                Not: Bu seÃ§im, hem "Mevcut" deseni (yÄ±l bazlÄ±) hem de optimizasyon aday Ã¼rÃ¼n havuzunu belirler.
              </p>
            </div>

            <div class="water-controls">
              <div class="field-row">
                <label class="field-label">Su yÄ±lÄ±</label>
                <select id="waterYear" class="select-input"></select>
              </div>
              <div class="field-row">
                <label class="field-label">Projeksiyon senaryosu (2025â€“2050)</label>
                <select id="waterScenarioSel" class="select-input">
                  <option value="mevcut" selected>mevcut</option>
                  <option value="iyi_adaptasyon">iyi_adaptasyon</option>
                  <option value="kotu_kuraklik">kotu_kuraklik</option>
                </select>
              </div>
              <div class="data-status">
                KullanÄ±labilir su: <strong id="availableWaterLabel">â€“</strong> mÂ³
                <span id="waterIndexBadge" class="badge badge-info">doluluk: â€“</span>
              </div>
              

              <p class="card-help small">
                Not: 2000â€“2025 deÄŸerleri Ã¶lÃ§Ã¼m/indeks serisinden, 2025â€“2050 deÄŸerleri ise seÃ§ili projeksiyon senaryosundan hesaplanÄ±r.
              </p>
            </div>

            <p class="card-help">
              SeÃ§ilen senaryo Ã¼rÃ¼n deseni, su kullanÄ±mÄ± ve kÃ¢r deÄŸerlerini gÃ¼nceller.
            </p>
          </div>

          
          <!-- GeliÅŸmiÅŸ / opsiyonel ayarlar: katlanabilir -->
          <details class="card details-card" id="liveSettingsCard">
            <summary>GeliÅŸmiÅŸ ayarlar (CanlÄ± veri & fiyat/teÅŸvik)</summary>
            <div class="details-body">

              <h2 class="card-title" style="margin-top:8px;">CanlÄ± veri ayarlarÄ±</h2>

              <div class="form-row">
                <label class="label">Meteoroloji kaynaÄŸÄ±</label>
                <select id="weatherSourceSel" class="select-input">
                  <option value="parcel" selected>Parsel iÃ§i Ã¶zet (offline)</option>
                  <option value="openmeteo">Openâ€‘Meteo (online)</option>
                </select>
              </div>

              <div class="grid-2">
                <div class="form-row">
                  <label class="label">Enlem (lat)</label>
                  <input id="weatherLat" class="text-input" type="number" step="0.0001" placeholder="37.97" />
                </div>
                <div class="form-row">
                  <label class="label">Boylam (lon)</label>
                  <input id="weatherLon" class="text-input" type="number" step="0.0001" placeholder="34.68" />
                </div>
              </div>

              <div class="grid-2">
                <div class="form-row">
                  <label class="label">BaÅŸlangÄ±Ã§</label>
                  <input id="weatherStart" class="text-input" type="date" />
                </div>
                <div class="form-row">
                  <label class="label">BitiÅŸ</label>
                  <input id="weatherEnd" class="text-input" type="date" />
                </div>
              </div>

              <div class="algo-actions" style="margin-top:8px;">
                <button id="btnFetchWeather" class="btn-secondary">Meteorolojiyi GÃ¼ncelle</button>
                <span id="weatherStatus" class="algo-status">Offline</span>
              </div>

              <hr class="hr" />

              <div class="form-row">
                <label class="label">Fiyat/TeÅŸvik kaynaÄŸÄ±</label>
                <select id="marketSourceSel" class="select-input">
                  <option value="local" selected>Yerel katalog (CSV)</option>
                  <option value="url">URL (CSV/JSON)</option>
                </select>
              </div>

              <div class="form-row">
                <label class="label">URL</label>
                <input id="marketUrl" class="text-input" type="text" placeholder="https://.../prices.csv veya .json" />
                <div class="hint small">
                  CSV kolon Ã¶rneÄŸi: <code>urun,fiyat_tl_kg,degisken_maliyet_tl_da,tesvik_tl_da</code>
                </div>
              </div>

              <div class="algo-actions" style="margin-top:8px;">
                <button id="btnLoadMarket" class="btn-secondary">Fiyat/TeÅŸviki YÃ¼kle</button>
                <span id="marketStatus" class="algo-status">Yerel</span>
              </div>
            </div>
          </details>

          <div class="card" id="parcelSummary">
            <h2 class="card-title">Parsel Ã–zeti</h2>
            <div class="parcel-summary-body">
              <!-- JS ile dolduruluyor -->
            </div>
          </div>
        </div>

        <!-- SaÄŸ ana kolon -->
        <div class="right-col">

          <!-- v72: KullanÄ±cÄ± seÃ§im yaptÄ± ama yeni optimizasyon Ã§alÄ±ÅŸtÄ±rmadÄ±ysa uyarÄ± -->
          <div id="staleBanner" class="stale-banner" style="display:none;">
            <div class="stale-banner-title">âš ï¸ SeÃ§im deÄŸiÅŸti</div>
            <div class="stale-banner-body">Ekrandaki sonuÃ§lar <b>Ã¶nceki Ã§alÄ±ÅŸtÄ±rmaya</b> aittir. Yeni sonuÃ§lar iÃ§in <b>Optimizasyonu Ã‡alÄ±ÅŸtÄ±r</b> butonuna basÄ±n.</div>
          </div>
          
          

<div class="right-top">
            <div class="card map-card">
              <div class="card-header-row">
                <h2 class="card-title">
Parsel HaritasÄ±</h2>
                <span class="card-subtitle">Harita Ã¼zerindeki parseller tÄ±klanarak da seÃ§ilebilir.</span>
              </div>
<div id="map" class="map-container"></div>
            </div>

            <div class="card metrics-card">
              <h2 class="card-title" id="metricsTitle">Senaryo Ã–zeti (15 parsel toplamÄ±)</h2>
              <div class="metrics-topnote">
                <span class="badge badge-info" id="globalBudgetBadge">KÃ¼resel su bÃ¼tÃ§esi: â€“</span>
                <span class="badge badge-warn" id="globalBudgetStatus">bÃ¼tÃ§e durumu: â€“</span>
              </div>

              <!-- v72: Karar gerekÃ§esi + koÅŸul ÅŸeffaflÄ±ÄŸÄ± -->
              <div id="runMetaBox" class="runmeta-box" style="display:none;"></div>
              <div class="metrics-grid">
                <div class="metric">
                  <div class="metric-label">Su KullanÄ±mÄ± (Mevcut)</div>
                  <div class="metric-value"><span id="mWaterCurrent">â€“</span> mÂ³</div>
                  <div class="metric-note">Referans durum</div>
                </div>
                <div class="metric">
                  <div class="metric-label">Su KullanÄ±mÄ± (SeÃ§ili senaryo)</div>
                  <div class="metric-value"><span id="mWaterScenario">â€“</span> mÂ³</div>
                  <div class="metric-pill pill-water" id="mWaterDiff">â€“</div>
                </div>
                <div class="metric">
                  <div class="metric-label">Toplam Net KÃ¢r (Mevcut)</div>
                  <div class="metric-value"><span id="mProfitCurrent">â€“</span> TL</div>
                  <div class="metric-note">Referans kÃ¢r</div>
                </div>
                <div class="metric">
                  <div class="metric-label">Toplam Net KÃ¢r (SeÃ§ili senaryo)</div>
                  <div class="metric-value"><span id="mProfitScenario">â€“</span> TL</div>
                  <div class="metric-pill pill-profit" id="mProfitDiff">â€“</div>
                </div>
                <div class="metric">
                  <div class="metric-label">Su VerimliliÄŸi (TL/mÂ³ â€“ Mevcut)</div>
                  <div class="metric-value"><span id="mEffCurrent">â€“</span></div>
                  <div class="metric-note">Mevcut desen</div>
                </div>
                <div class="metric">
                  <div class="metric-label">Su VerimliliÄŸi (TL/mÂ³ â€“ SeÃ§ili senaryo)</div>
                  <div class="metric-value"><span id="mEffScenario">â€“</span></div>
                  <div class="metric-pill pill-eff" id="mEffDiff">â€“</div>
                </div>
              </div>

              <!-- Karar gerekÃ§esi: SayÄ±sal kartlarÄ±n hemen altÄ±nda, kuraklÄ±k Ã¶nerisinin Ã¼stÃ¼nde -->
              <div id="decisionRationale" class="rationale-box" style="display:none;"></div>


            
<div class="drought-impact-box" id="droughtImpactBox">
  <div class="drought-impact-title">âš ï¸ KuraklÄ±k Etkisi â€“ Ã–neri</div>
  <div class="drought-impact-body">
    <div class="drought-impact-col">
      <div class="drought-impact-sub">KaÃ§Ä±n / azalt</div>
      <ul class="drought-impact-list" id="droughtAvoidList"></ul>
    </div>
    <div class="drought-impact-col">
      <div class="drought-impact-sub">Tercih et</div>
      <ul class="drought-impact-list" id="droughtPreferList"></ul>
    </div>
  </div>
  <div class="drought-impact-note" id="droughtImpactNote">â€”</div>
              </div>
            </div>
          </div>

<div class="card drought-details-card">
  <details class="drought-details" open>
    <summary class="drought-details__summary"><span class="drought-details__title">KuraklÄ±k gÃ¶stergeleri (2000â€“2025) â€“ Detay</span><span class="drought-summary-badge" id="droughtSummaryBadge">KRÄ°TÄ°K</span></summary>
    <div class="drought-details__body">
      <div class="card drought-main-container">
            <h2 class="card-title">Akkaya BarajÄ± KuraklÄ±k GÃ¶stergeleri (2000â€“2025)</h2>
            <p class="card-help small">Grafik Ã¼zerinde gezerek yÄ±llÄ±k deÄŸerleri gÃ¶rebilirsiniz. SeÃ§ili â€œSu yÄ±lÄ±â€ vurgulanÄ±r; kritik yÄ±llarda panel dikkat Ã§ekici biÃ§imde Ã¶ne Ã§Ä±kar.</p>
            <div id="droughtAlarmCard" class="drought-card">
                            <div class="drought-card__head">
                              <span class="drought-card__title">KuraklÄ±k AlarmÄ±</span>
                              <span id="droughtAlarmLevel" class="badge badge-warn">â€“</span>
                            </div>
                            <div class="drought-layout">
                              <div class="drought-chart-wrap drought-chart-wrap--main">
                                <canvas id="droughtSeriesChart" height="260"></canvas>
                              </div>

                              <div class="drought-side">
                                <div class="drought-grid drought-grid--side">
                                  <div class="drought-metric">
                                    <div class="drought-metric__label">Min doluluk</div>
                                    <div class="drought-metric__value drought-metric__value--big"><span id="droughtMinPct">â€“</span><span class="unit">%</span></div>
                                  </div>
                                  <div class="drought-metric">
                                    <div class="drought-metric__label">Ortalama</div>
                                    <div class="drought-metric__value drought-metric__value--big"><span id="droughtAvgPct">â€“</span><span class="unit">%</span></div>
                                  </div>
                                  <div class="drought-metric">
                                    <div class="drought-metric__label">Stres endeksi</div>
                                    <div class="drought-metric__value drought-metric__value--big"><span id="droughtStressIdx">â€“</span></div>
                                  </div>
                                </div>

                                <div id="droughtAlarmText" class="drought-note small">â€“</div>
                                <div class="small muted" style="margin-top:8px;">Ä°pucu: Grafikteki noktalara gelerek yÄ±llÄ±k deÄŸerleri gÃ¶rebilirsiniz.</div>
                              </div>
                            </div>

                          </div>
</div>
    </div>
  </details>
</div>



          <div class="right-middle">
                      <div class="card small-chart-card">
                        <h3 class="card-subtitle">Senaryolara GÃ¶re Toplam Su KullanÄ±mÄ±</h3>
                        <canvas id="waterChart" height="150"></canvas>
                      </div>
                      <div class="card small-chart-card">
                        <h3 class="card-subtitle">Senaryolara GÃ¶re Toplam Net KÃ¢r</h3>
                        <canvas id="profitChart" height="150"></canvas>
                      </div>
                      <div class="card small-chart-card">
                        <h3 class="card-subtitle">SeÃ§ili Parsel â€“ Ã–nerilen ÃœrÃ¼nler (Rotasyon)</h3>
                        <div id="productCards" class="product-cards" aria-label="Ã–nerilen Ã¼rÃ¼nler"></div>
                      </div>
                    </div>

<div class="tabs">
              <button class="tab active" data-tab="parcel">Parsel dÃ¼zeyi desen</button>
              <button class="tab" data-tab="district">Ä°lÃ§e / il dÃ¼zeyi Ã¶zet</button>
              <button class="tab" data-tab="official">ResmÃ® tablolar (Ã¶zet)</button>
              <button class="tab" data-tab="water">Su bÃ¼tÃ§esi (2000â€“2050)</button>
<button class="tab" data-tab="benchmark">Algoritma karÅŸÄ±laÅŸtÄ±rmasÄ±</button>
              <button class="tab" data-tab="plan5">5 yÄ±llÄ±k plan</button>
              <button class="tab" data-tab="impact">15 yÄ±llÄ±k etki</button>
            </div>

            <div class="tab-panels">
              <div class="tab-panel active" id="tab-parcel">
                <div class="tables-row">
                  <div class="card table-card">
                    <h3 class="card-subtitle">Mevcut ÃœrÃ¼n Deseni</h3>
                    <p class="card-help small">
                      SeÃ§ili parselde bugÃ¼nkÃ¼ varsayÄ±lan desen.
                    </p>
                    <table class="data-table" id="tblCurrent">
                      <thead>
                        <tr>
                          <th>ÃœrÃ¼n</th>
                          <th>Mevsim</th>
                          <th>Sulama (Mevcut)</th>
                          <th>Ekim AlanÄ± (da â€“ sezon)</th>
                          <th>Su (mÂ³/da)</th>
                          <th>Toplam Su</th>
                          <th>KÃ¢r (TL/da)</th>
                          <th>Toplam KÃ¢r</th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                    <div class="table-footer" id="tblCurrentFooter"></div>
                  </div>

                  <div class="card table-card">
                    <h3 class="card-subtitle">Ã–nerilen ÃœrÃ¼n Deseni (Senaryo + Algoritma)</h3>
                    <p class="card-help small">
                      SeÃ§ili senaryo ve algoritmaya gÃ¶re oluÅŸan yeni desen.
                    </p>
                    <table class="data-table" id="tblRecommended">
                      <thead>
                        <tr>
                          <th>ÃœrÃ¼n</th>
                          <th>Mevsim</th>
                          <th>Sulama (Ã–neri)</th>
                          <th>Ekim AlanÄ± (da â€“ sezon)</th>
                          <th>Su (mÂ³/da)</th>
                          <th>Toplam Su</th>
                          <th>KÃ¢r (TL/da)</th>
                          <th>Toplam KÃ¢r</th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                    <div class="table-footer" id="tblRecommendedFooter"></div>
                  </div>
                </div>

                <div class="tables-row" style="margin-top:14px;">
                  <div class="card table-card">
                    <h3 class="card-subtitle">AÃ§Ä±klanabilirlik (kÄ±sÄ±tlar & nedenler)</h3>
                    <div id="explainBox" class="explain-box">â€”</div>
                  </div>

                  <div class="card table-card">
                    <h3 class="card-subtitle">Rotasyon / 2. ÃœrÃ¼n Ã–nerisi (basit kurallar)</h3>
                    <div id="rotationBox" class="explain-box">â€”</div>
                  </div>
                </div>

                <div class="card table-card" style="margin-top:14px;">
                  <h3 class="card-subtitle">AylÄ±k Su DaÄŸÄ±tÄ±m Kapasitesi KontrolÃ¼</h3>
                  <p class="card-help small">Ä°letim kapasitesi varsa, seÃ§ili desenin aylÄ±k su talebi ile karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r. FAO-56 aylÄ±k ETc tahmini mevcutsa onunla; yoksa ay-aÄŸÄ±rlÄ±k yaklaÅŸÄ±mÄ±yla hesaplanÄ±r.</p>
                  <div id="deliveryBox" class="explain-box">â€”</div>
                </div>

                <div class="card" style="margin-top:14px;">
                  <h3 class="card-subtitle">SeÃ§ili parsel iÃ§in dÃ¶nemsel sulama planÄ± (EToÃ—Kc â€“ hÄ±zlÄ± tahmin)</h3>
                  <p class="card-help small">Not: Bu tablo, parselin yÄ±llÄ±k ETo/yaÄŸÄ±ÅŸ Ã¶zeti Ã¼zerinden basitleÅŸtirilmiÅŸ bir ETc hesabÄ±yla Ã¼retilir. GerÃ§ek uygulamada aylÄ±k MGM verisi ile hassaslaÅŸtÄ±rÄ±lÄ±r.</p>
                  <div id="irrigPlanBox" class="explain-box">â€”</div>
                </div>

 
              </div>

              <div class="tab-panel" id="tab-district">
                <div class="card">
                  <h3 class="card-subtitle">Ä°lÃ§e / il dÃ¼zeyi Ã¶zet</h3>
                  <p class="card-help">
                    Bu bÃ¶lÃ¼mde NiÄŸde ilÃ§eleri iÃ§in 2024 yÄ±lÄ± tarla, sebze ve meyve alanlarÄ±nÄ±n
                    Ã¶zet daÄŸÄ±lÄ±mÄ± ve sulanan/sulanmayan alan oranlarÄ± gÃ¶sterilmektedir.
                    Veriler temsili olarak eklenmiÅŸtir.
                  </p>
                  <div class="district-row">
                    <canvas id="districtAreaChart" height="150"></canvas>
                    <canvas id="districtIrrigChart" height="150"></canvas>
                    <canvas id="provinceShareChart" height="150"></canvas>
                  </div>
                </div>
              </div>

              <div class="tab-panel" id="tab-official">
                <div class="tables-row">
                  <div class="card table-card">
                    <h3 class="card-subtitle">Havza Su BÃ¼tÃ§esi â€“ ResmÃ® Ã–zet</h3>
                    <p class="card-help small">SeÃ§ili su yÄ±lÄ±/senaryosu Ã¼zerinden hesaplanan toplam kullanÄ±labilir su ve mevcut talep.</p>
                    <table class="data-table" id="tblOfficialWater">
                      <thead>
                        <tr><th>GÃ¶sterge</th><th>DeÄŸer</th><th>Birim</th></tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                    <div class="table-footer" style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
                      <button class="btn" id="btnExportWaterCsv">CSV indir</button>
                      <span class="small muted" id="officialWaterNote">â€”</span>
                    </div>
                  </div>

                  <div class="card table-card">
                    <h3 class="card-subtitle">SeÃ§ili Senaryoya GÃ¶re Optimum Bitki Deseni â€“ ResmÃ®</h3>
                    <p class="card-help small">15 parselin tamamÄ± iÃ§in Ã¼rÃ¼n bazÄ±nda ekim alanÄ± (sezon/dÃ¶nem bazÄ±nda), su ve kÃ¢r toplulaÅŸtÄ±rmasÄ±. Rotasyon/2. Ã¼rÃ¼n varsa aynÄ± parsel alanÄ± yÄ±l iÃ§inde birden fazla Ã¼rÃ¼nle deÄŸerlendirilebilir.</p>
                    <table class="data-table" id="tblOfficialScenario">
                      <thead>
                        <tr>
                          <th>ÃœrÃ¼n</th><th>Ekim AlanÄ± (da â€“ sezon)</th><th>Toplam Su (mÂ³)</th><th>Toplam KÃ¢r (TL)</th><th>Su VerimliliÄŸi (TL/mÂ³)</th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                    <div class="table-footer" id="tblOfficialScenarioFooter" style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
                      <button class="btn" id="btnExportScenarioCsv">CSV indir</button>
                      <span class="small muted" id="officialScenarioNote">â€”</span>
                    </div>
                  </div>
                </div>

                <div class="card table-card" style="margin-top:14px;">
                  <h3 class="card-subtitle">Parsel BazlÄ± Ã–zet â€“ ResmÃ®</h3>
                  <p class="card-help small">Her parsel iÃ§in seÃ§ili senaryo+algoritma sonucunun su/kÃ¢r Ã¶zeti (kÃ¼resel su bÃ¼tÃ§esi sonrasÄ±).</p>
                  <table class="data-table" id="tblOfficialParcels">
                    <thead>
                      <tr>
                        <th>Parsel</th><th>Alan (da)</th><th>Toplam Su (mÂ³)</th><th>Toplam KÃ¢r (TL)</th><th>Su VerimliliÄŸi (TL/mÂ³)</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                  <div class="table-footer" style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
                    <button class="btn" id="btnExportParcelsCsv">CSV indir</button>
                    <span class="small muted">Not: Bu tablolar, rapora doÄŸrudan eklenebilir/Excelâ€™e aktarÄ±labilir formatta Ã¼retilir.</span>
                  </div>
                </div>

                <div class="card table-card" style="margin-top:14px;">
                  <h3 class="card-subtitle">TÃ¼m Parseller â€“ Mevcut vs Ã–nerilen (Åeffaf KarÅŸÄ±laÅŸtÄ±rma)</h3>
                  <p class="card-help small">
                    Ã‡iftÃ§i iÃ§in: Her parselde mevcut ekim deseni ile seÃ§ili senaryo+algoritma sonucu Ã¶nerilen desen yan yana.
                    Her parsel satÄ±rÄ±nda "KÄ±yasla" ile alternatif Ã¼rÃ¼nlerin su/kÃ¢r karÅŸÄ±laÅŸtÄ±rmasÄ± gÃ¶rÃ¼lebilir.
                  </p>
                  <div class="table-footer" style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:8px;">
                    <button class="btn" id="btnExportAllParcelCompareCsv">CSV indir</button>
                    <span class="small muted" id="allParcelCompareNote">Not: Ã–neriler, son "Optimizasyonu Ã‡alÄ±ÅŸtÄ±r" sonucuyla senkron tutulur.</span>
                  </div>
                  <div style="overflow:auto;">
                    <table class="data-table" id="tblOfficialAllParcelCompare">
                      <thead>
                        <tr>
                          <th>Parsel</th>
                          <th>Alan (da)</th>
                          <th>Mevcut Desen (mevsim)</th>
                          <th>Mevcut Su (mÂ³)</th>
                          <th>Mevcut KÃ¢r (TL)</th>
                          <th>Ã–nerilen Desen (mevsim)</th>
                          <th>Ã–neri Su (mÂ³)</th>
                          <th>Ã–neri KÃ¢r (TL)</th>
                          <th>Î” Su</th>
                          <th>Î” KÃ¢r</th>
                          <th>Neden?</th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                  </div>
                </div>

                <div class="card table-card" style="margin-top:14px;">
                  <h3 class="card-subtitle">KÃ¶y / Ä°lÃ§e bazlÄ± resmÃ® ekim desenleri (paketten Ã¶zet)</h3>
                  <p class="card-help small">Bu bÃ¶lÃ¼m, veri paketindeki Excel tablolarÄ±ndan tÃ¼retilen Ã¶zetleri gÃ¶sterir (kullanÄ±lan bonuslar buradan gelir).</p>
                  <div id="officialSummary" class="small"></div>
                </div>
              </div>

              <div class="tab-panel" id="tab-water">
                <div class="card">
                  <h3 class="card-subtitle">Su bÃ¼tÃ§esi ve zaman serisi (2000â€“2050)</h3>
                  <p class="card-help">
                    Akkaya barajÄ± iÃ§in 2000â€“2025 dÃ¶nemi yÄ±llÄ±k gÃ¶rece doluluk endeksi ve 2050â€™ye kadar
                    Ã¼Ã§ senaryo (mevcut gidiÅŸat, su tasarruf odaklÄ± desen, maksimum kÃ¢r odaklÄ± desen)
                    iÃ§in projeksiyonlar gÃ¶sterilmektedir.
                  </p>
                  <div class="district-row">
                    <canvas id="storageHistoryChart" height="150"></canvas>
                    <canvas id="storageScenarioChart" height="150"></canvas>
                  </div>
                </div>
              </div>

              <div class="tab-panel" id="tab-drought">
                <div class="card">
                  <h2 class="card-title">KuraklÄ±k gÃ¶stergeleri</h2>
                  <p class="card-help small">KuraklÄ±k grafikleri Ã¼st bÃ¶lÃ¼mde â€œKuraklÄ±k gÃ¶stergeleri (2000â€“2025) â€“ Detayâ€ alanÄ±nda yer almaktadÄ±r.</p>
                </div>
              </div>

          <!-- Algoritma KarÅŸÄ±laÅŸtÄ±rma Sekmesi -->
              <div class="tab-panel" id="tab-benchmark">
                <div class="card">
                  <h2 class="card-title">Algoritma karÅŸÄ±laÅŸtÄ±rmasÄ± (Benchmark)</h2>
                  <div id="benchmarkLoadedBadge" class="badge badge-info" style="display:inline-block; margin-top:6px;">Benchmark sekmesi yÃ¼klendi.</div>
                  <p class="card-help small" style="margin-top:-6px;">
                    GA/ABC/ACO stokastik olduÄŸu iÃ§in her koÅŸuÅŸta farklÄ± sonuÃ§ Ã¼retmesi normaldir. Buradan aynÄ± koÅŸullarda
                    algoritmalarÄ± tekrar tekrar Ã§alÄ±ÅŸtÄ±rÄ±p ortalamaâ€“en iyiâ€“oynaklÄ±k (std) deÄŸerlerini ve <strong>Ã¶nerilen desenleri</strong> karÅŸÄ±laÅŸtÄ±rabilirsiniz.
                    <br/><span class="muted">Not: â€œMevcut desenâ€ seÃ§iliyken algoritma kÄ±yasÄ± anlamlÄ± deÄŸildir; kÄ±yas iÃ§in Su Tasarruf / Maks KÃ¢r / Dengeli seÃ§in.</span>
                  </p>

                  <div class="water-controls" style="padding-top:6px;">
                    <div class="field-row">
                      <label class="field-label">KarÅŸÄ±laÅŸtÄ±rma senaryosu</label>
                      <select id="benchmarkSeasonSourceSel" class="select-input">
                        <option value="use_selected" selected>SeÃ§ili (soldaki Sezon veri seti)</option>
                        <option value="s1">Senaryo-1 (tek baÅŸÄ±na)</option>
                        <option value="s2">Senaryo-2 (tek baÅŸÄ±na)</option>
                        <option value="all">ÃœÃ§Ã¼nÃ¼ de Ã§alÄ±ÅŸtÄ±r (karÅŸÄ±laÅŸtÄ±r)</option>
                      </select>
                    </div>
                    <div class="field-row">
                      <label class="field-label">Tekrar sayÄ±sÄ±</label>
                      <input id="benchmarkRepeats" class="text-input" type="number" min="1" max="60" value="15" />
                    </div>
                    <div class="field-row">
                      <label class="field-label">Seed (opsiyonel)</label>
                      <input id="benchmarkSeed" class="text-input" type="number" placeholder="boÅŸ = rastgele" />
                    </div>
                    <div class="algo-actions" style="margin-top:8px;">
                      <button id="runBenchmarkBtn" class="btn-secondary">KarÅŸÄ±laÅŸtÄ±rmayÄ± Ã‡alÄ±ÅŸtÄ±r</button>
                      <span id="benchmarkStatus" class="algo-status">HazÄ±r</span>
                    </div>
                  </div>

                  <div id="benchmarkResults" class="small" style="margin-top:10px;"></div>


                  <div class="chart-grid" style="margin-top:10px;">
                    <div class="chart-card" style="height:210px;">
                      <div class="chart-title">Ortalama Net KÃ¢r (TL)</div>
                      <canvas id="benchmarkProfitChart"></canvas>
                    </div>
                    <div class="chart-card" style="height:210px;">
                      <div class="chart-title">Ortalama Su KullanÄ±mÄ± (mÂ³)</div>
                      <canvas id="benchmarkWaterChart"></canvas>
                    </div>
                    <div class="chart-card" style="height:210px;">
                      <div class="chart-title">Ortalama Su VerimliliÄŸi (TL/mÂ³)</div>
                      <canvas id="benchmarkEffChart"></canvas>
                    </div>
                  </div>

                  <div id="benchmarkPatterns" style="margin-top:14px;"></div>
                </div>
              </div>

              <!-- 15 YÄ±llÄ±k Etki Analizi Sekmesi -->
              <div class="tab-panel" id="tab-plan5">
                <div class="tables-row">
                  <div class="card table-card">
                    <h3 class="card-subtitle">5 YÄ±llÄ±k (Kayan) Ekim PlanÄ±</h3>
                    <p class="card-help small">
                      Bu plan â€œkesin takvimâ€ deÄŸildir. YÄ±l 1 Ã¶nerisi seÃ§ili senaryo ve algoritma Ã§Ä±ktÄ±sÄ±dÄ±r; YÄ±l 2â€“5 ise mÃ¼navebe kurallarÄ± ve su bÃ¼tÃ§esi projeksiyonuna gÃ¶re Ã¼retilen Ã¶neri rotalardÄ±r.
                      Her sezon sonunda veriler gÃ¼ncellenerek plan yenilenmelidir.
                    </p>

                    
                    <div class="row" style="display:flex; gap:10px; align-items:flex-end; flex-wrap:wrap; margin:10px 0 6px;">
                      <div style="min-width:220px;">
                        <div class="small" style="margin-bottom:6px; opacity:.8;">Parsel bazlÄ± gÃ¶rÃ¼ntÃ¼le</div>
                        <select id="plan5ParcelSelect" class="select-input"></select>
                      </div>
                      <div class="small" id="plan5ParcelNote" style="opacity:.8; padding-bottom:6px;">
                        â€œTÃ¼mÃ¼â€ seÃ§ilirse genel Ã¶zet ve tÃ¼m parseller listelenir.
                      </div>
                    </div>
                    <div class="kpi-row" style="margin-top:8px;">
                      <div class="kpi">
                        <div class="kpi-label">5 yÄ±lda kÃ¢r etkisi</div>
                        <div class="kpi-value" id="plan5ProfitKpi">â€”</div>
                        <div class="kpi-sub" id="plan5ProfitKpiSub">Mevcut desene gÃ¶re</div>
                      </div>
                      <div class="kpi">
                        <div class="kpi-label">Nadas payÄ±</div>
                        <div class="kpi-value" id="plan5NadasKpi2">â€”</div>
                        <div class="kpi-sub" id="plan5NadasKpi2Sub">Toplam alan payÄ±</div>
                      </div>
                      <div class="kpi">
                        <div class="kpi-label">Toprak etkisi nasÄ±l hesaplandÄ±?</div>
                        <div class="kpi-value" id="plan5SoilExplain">â€”</div>
                        <div class="kpi-sub">Baklagil + Ã¶rtÃ¼ bitkisi + rotasyon bonusu, tekdÃ¼ze ekim cezasÄ±</div>
                      </div>
                    </div>

<div class="kpi-row">
                      <div class="kpi">
                        <div class="kpi-label">5 yÄ±lda su etkisi</div>
                        <div class="kpi-value" id="plan5WaterKpi">â€”</div>
                        <div class="kpi-sub" id="plan5WaterKpiSub">Mevcut desene gÃ¶re</div>
                      </div>
                      <div class="kpi">
                        <div class="kpi-label">Toprak saÄŸlÄ±ÄŸÄ± etkisi</div>
                        <div class="kpi-value" id="plan5SoilKpi">â€”</div>
                        <div class="kpi-sub" id="plan5SoilKpiSub">MÃ¼navebe + baklagil + Ã¶rtÃ¼ bitkisi</div>
                      </div>
                      <div class="kpi">
                        <div class="kpi-label">Nadas etkisi</div>
                        <div class="kpi-value" id="plan5NadasKpi">â€”</div>
                        <div class="kpi-sub" id="plan5NadasKpiSub">Toplam alan payÄ±</div>
                      </div>
                    </div>

                    <div class="kpi-row">
                      <div class="kpi">
                        <div class="kpi-label">Refaha geÃ§iÅŸ (tahmini)</div>
                        <div class="kpi-value" id="plan5ProsperKpi">â€”</div>
                        <div class="kpi-sub" id="plan5ProsperKpiSub">Su bÃ¼tÃ§esi toparlanÄ±nca yÃ¼ksek kÃ¢rlÄ± desenlere geÃ§iÅŸ</div>
                      </div>
                      <div class="kpi">
                        <div class="kpi-label">ÃœrÃ¼n deseni deÄŸiÅŸimi</div>
                        <div class="kpi-value" id="plan5ShiftKpi">â€”</div>
                        <div class="kpi-sub" id="plan5ShiftKpiSub">DÃ¼ÅŸÃ¼k su â†’ dengeli â†’ yÃ¼ksek kÃ¢r fazlarÄ±</div>
                      </div>
                      <div class="kpi">
                        <div class="kpi-label">Hesap mantÄ±ÄŸÄ±</div>
                        <div class="kpi-value" style="font-size:16px; line-height:1.2;" id="plan5Formula">AlanÃ—(VerimÃ—Fiyatâˆ’Maliyet)</div>
                        <div class="kpi-sub">Su = AlanÃ—(mÂ³/da). YÄ±l-1: algoritma Ã§Ä±ktÄ±sÄ±; YÄ±l-2..5: su bÃ¼tÃ§esi+rotasyon</div>
                      </div>
                    </div>

                    <div class="table-scroll">
                      <table class="data-table" id="plan5Table">
                        <thead>
                          <tr>
                            <th>Parsel</th>
                            <th>YÄ±l</th>
                            <th>1. ÃœrÃ¼n</th>
                            <th>2. ÃœrÃ¼n</th>
                            <th>Su (mÂ³)</th>
                            <th>KÃ¢r (TL)</th>
                            <th>Toprak Etkisi</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                      </table>
                    </div>

                    <div class="callout" id="plan5Callout">
                      <strong>Ã‡arpÄ±cÄ± not:</strong>
                      <span>Baklagil (nohut/mercimek vb.) rotasyona girdiÄŸinde azot baÄŸlama ile gÃ¼bre ihtiyacÄ± azalÄ±r; Ã¶rtÃ¼ bitkileri yÃ¼zeyin Ã§Ä±plak kalmasÄ±nÄ± engelleyerek erozyon ve organik madde kaybÄ±nÄ± dÃ¼ÅŸÃ¼rÃ¼r.
                      Bu nedenle â€œnadas yerine dÃ¼ÅŸÃ¼k su rotasyonuâ€ uzun vadede hem su verimliliÄŸini hem de toprak dayanÄ±klÄ±lÄ±ÄŸÄ±nÄ± artÄ±rÄ±r.</span>
                    </div>

                  </div>
                </div>
              </div>
              <div class="tab-panel" id="tab-impact">
                <div class="card">
                  <h2 class="card-title">15 yÄ±llÄ±k etki analizi</h2>
                  <p class="card-help small" style="margin-top:-6px;">
                    SeÃ§ili senaryo/Sezon veri setine gÃ¶re GA/ACO/ABC iÃ§in <strong>15 yÄ±llÄ±k su tasarrufu</strong> ve <strong>15 yÄ±llÄ±k kÃ¢r projeksiyonu</strong> hesaplanÄ±r.
                    AyrÄ±ca <strong>GA+ACO+ABC ortalamasÄ±</strong> ayrÄ± gÃ¶sterilir.
                  </p>

                  <div class="water-controls" style="padding-top:6px;">
                    <div class="field-row">
                      <label class="field-label">Hesaplama veri seti</label>
                      <select id="impactSeasonSourceSel" class="select-input">
                        <option value="use_selected" selected>SeÃ§ili (soldaki Sezon veri seti)</option>
                        <option value="s1" selected>Senaryo-1 (tek baÅŸÄ±na)</option>
                        <option value="s2">Senaryo-2 (tek baÅŸÄ±na)</option>
                      </select>
                    </div>
                    <div class="field-row">
                      <label class="field-label">Ufuk (yÄ±l)</label>
                      <input id="impactHorizonYears" class="text-input" type="number" value="15" min="1" max="30" />
                    </div>
                    <div class="field-row">
                      <label class="field-label">Tekrar (her algoritma)</label>
                      <input id="impactRepeats" class="text-input" type="number" value="8" min="1" max="30" />
                    </div>
                  </div>

                  <div class="algo-actions" style="margin-top:8px; gap:8px; flex-wrap:wrap;">
                    <button id="runImpact15yBtn" class="btn-secondary">15Y Su Tasarrufu (GeoJSON)</button>
                    <button id="runProfit15yBtn" class="btn-secondary">15Y Ortalama KÃ¢r (GeoJSON)</button>
                    <span id="impact15yStatus" class="algo-status">HazÄ±r</span>
                  </div>

                  <div id="impact15ySummary" class="small" style="margin-top:10px;"></div>
                  <div id="profit15ySummary" class="small" style="margin-top:10px;"></div>

                  <div class="chart-grid" style="margin-top:10px;">
                    <div class="chart-card" style="height:240px;">
                      <div class="chart-title">15 YÄ±llÄ±k KÃ¼mÃ¼latif Su Tasarrufu (mÂ³)</div>
                      <canvas id="impactWater15Chart"></canvas>
                    </div>
                    <div class="chart-card" style="height:240px;">
                      <div class="chart-title">15 YÄ±llÄ±k KÃ¼mÃ¼latif KÃ¢r FarkÄ± (TL)</div>
                      <canvas id="impactProfit15Chart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

<section class="thesis-quote enhanced">
  <div class="quote-wrap">
    <img src="images/ohmu_logo_1992.png" alt="NiÄŸde Ã–mer Halisdemir Ãœniversitesi Logosu" class="quote-logo left">
    <div class="quote-center">
      <p class="quote-text">
        â€œSuyunu koruyamayan bir tarÄ±m, topraÄŸÄ±nÄ±;<br>
        topraÄŸÄ±nÄ± koruyamayan bir millet, geleceÄŸini kaybeder.â€
      </p>
      <p class="quote-author">
        HazÄ±rlayan: <strong>BetÃ¼l Demir</strong> â€“ YÃ¼ksek Lisans Tezi<br>
        NiÄŸde Ã–mer Halisdemir Ãœniversitesi
      </p>

      <div class="quote-audio" aria-label="Ziraat MarÅŸÄ± Ses OynatÄ±cÄ±">
        <div class="quote-audio-label">
          <span class="music-emoji" aria-hidden="true">ğŸµ</span>
          <span>Ziraat MarÅŸÄ±</span>
        </div>
        <audio controls preload="metadata">
          <source src="audio/ziraat_marsi.mp4" type="audio/mp4" />
          TarayÄ±cÄ±nÄ±z ses oynatmayÄ± desteklemiyor.
        </audio>
      </div>
    </div>

    <img src="images/ahmet_sahenk_logo.png" alt="NiÄŸde Ã–mer Halisdemir Ãœniversitesi MÃ¼hrÃ¼" class="quote-logo right">

  </div>
</section>

</main>

    <footer class="app-footer">
      Akkaya BarajÄ± Optimum Bitki Deseni Ã‡alÄ±ÅŸmasÄ±
    </footer>
  </div>

  <script src="script.js?v=114"></script>
</body>
</html>